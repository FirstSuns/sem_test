{{ 'our-newsletter.css' | asset_url | stylesheet_tag }}
{{ 'our-newsletter.js' | asset_url | stylesheet_tag }}
<div class="our-newsletter-section">
  {% if section.settings.bg_image != blank %}
    <figure class="news-fig">
      {% comment %} {% assign image = section.settings.bg_image %}
      <img
        srcset="
          {%- if image.width >= 165 -%}{{ image | image_url: width: 165 }} 165w,{%- endif -%}
          {%- if image.width >= 360 -%}{{ image | image_url: width: 360 }} 360w,{%- endif -%}
          {%- if image.width >= 533 -%}{{ image | image_url: width: 533 }} 533w,{%- endif -%}
          {%- if image.width >= 720 -%}{{ image | image_url: width: 720 }} 720w,{%- endif -%}
          {%- if image.width >= 940 -%}{{ image | image_url: width: 940 }} 940w,{%- endif -%}
          {%- if image.width >= 1066 -%}{{ image | image_url: width: 2066 }} 2066w,{%- endif -%}
          {{ image | image_url }} {{ image.width }}w
        "
        src="{{ image | image_url: 'master' }}"
        sizes="(min-width: {{ settings.page_width }}px) {{ settings.page_width | minus: 130 | divided_by: 4 }}px, (min-width: 990px) calc((100vw - 130px) / 4), (min-width: 750px) calc((100vw - 120px) / 3), calc((100vw - 35px) / 2)"
        alt="{{ image.alt | escape }}"
        {% unless lazy_load == false %}
          loading="lazy"
        {% endunless %}
        width="{{ image.width }}"
        height="{{ image.height }}"
      > {% endcomment %}
      
        {%- liquid
          assign image_height = section.settings.bg_image.width | divided_by: section.settings.bg_image.aspect_ratio
            assign sizes = full_width
        -%}
        {{
            section.settings.bg_image
            | image_url: width: 3840
            | image_tag:
              loading: 'lazy',
              width: section.settings.bg_image.width,
              height: image_height,
              sizes: sizes,
              widths: widths
          }}
      
    </figure>
  {% endif %}
  <div class="page-width">
    <div class="our-newsletter">
      <div class="our-newsletter-title">
        <div class="our-newsletter-icon">
          {% if section.settings.icon_01 != blank %}
            <figure>
              {% assign image = section.settings.icon_01 %}
              <img
                srcset="
                  {%- if image.width >= 165 -%}{{ image | image_url: width: 165 }} 165w,{%- endif -%}
                  {%- if image.width >= 360 -%}{{ image | image_url: width: 360 }} 360w,{%- endif -%}
                  {%- if image.width >= 533 -%}{{ image | image_url: width: 533 }} 533w,{%- endif -%}
                  {%- if image.width >= 720 -%}{{ image | image_url: width: 720 }} 720w,{%- endif -%}
                  {%- if image.width >= 940 -%}{{ image | image_url: width: 940 }} 940w,{%- endif -%}
                  {%- if image.width >= 1066 -%}{{ image | image_url: width: 2066 }} 2066w,{%- endif -%}
                  {{ image | image_url }} {{ image.width }}w
                "
                src="{{ image | image_url: 'master' }}"
                sizes="(min-width: {{ settings.page_width }}px) {{ settings.page_width | minus: 130 | divided_by: 4 }}px, (min-width: 990px) calc((100vw - 130px) / 4), (min-width: 750px) calc((100vw - 120px) / 3), calc((100vw - 35px) / 2)"
                alt="{{ image.alt | escape }}"
                {% unless lazy_load == false %}
                  loading="lazy"
                {% endunless %}
                width="{{ image.width }}"
                height="{{ image.height }}"
              >
              {% comment %}
                    {%- liquid
                    assign image_height = section.settings.icon_01.width | divided_by: section.settings.icon_01.aspect_ratio
                      assign sizes = full_width
                  -%}
                {{
                    section.settings.icon_01
                    | image_url: width: 3840
                    | image_tag:
                      loading: 'lazy',
                      width: section.settings.icon_01.width,
                      height: image_height,
                      sizes: sizes,
                      widths: widths
                  }}
              {% endcomment %}
            </figure>
          {% endif %}

          {% if section.settings.icon_02 != blank %}
            <figure>
              {% assign image = section.settings.icon_02 %}
              <img
                srcset="
                  {%- if image.width >= 165 -%}{{ image | image_url: width: 165 }} 165w,{%- endif -%}
                  {%- if image.width >= 360 -%}{{ image | image_url: width: 360 }} 360w,{%- endif -%}
                  {%- if image.width >= 533 -%}{{ image | image_url: width: 533 }} 533w,{%- endif -%}
                  {%- if image.width >= 720 -%}{{ image | image_url: width: 720 }} 720w,{%- endif -%}
                  {%- if image.width >= 940 -%}{{ image | image_url: width: 940 }} 940w,{%- endif -%}
                  {%- if image.width >= 1066 -%}{{ image | image_url: width: 2066 }} 2066w,{%- endif -%}
                  {{ image | image_url }} {{ image.width }}w
                "
                src="{{ image | image_url: 'master' }}"
                sizes="(min-width: {{ settings.page_width }}px) {{ settings.page_width | minus: 130 | divided_by: 4 }}px, (min-width: 990px) calc((100vw - 130px) / 4), (min-width: 750px) calc((100vw - 120px) / 3), calc((100vw - 35px) / 2)"
                alt="{{ image.alt | escape }}"
                {% unless lazy_load == false %}
                  loading="lazy"
                {% endunless %}
                width="{{ image.width }}"
                height="{{ image.height }}"
              >
              {% comment %}
                {%- liquid
                  assign image_height = section.settings.icon_02.width | divided_by: section.settings.icon_02.aspect_ratio
                  assign sizes = full_width
                -%}
                {{
                  section.settings.icon_02
                  | image_url: width: 3840
                  | image_tag:
                    loading: 'lazy',
                    width: section.settings.icon_02.width,
                    height: image_height,
                    sizes: sizes,
                    widths: widths
                }}
              {% endcomment %}
            </figure>
          {% endif %}

          {% if section.settings.icon_03 != blank %}
            <figure>
              {% assign image = section.settings.icon_03 %}
              <img
                srcset="
                  {%- if image.width >= 165 -%}{{ image | image_url: width: 165 }} 165w,{%- endif -%}
                  {%- if image.width >= 360 -%}{{ image | image_url: width: 360 }} 360w,{%- endif -%}
                  {%- if image.width >= 533 -%}{{ image | image_url: width: 533 }} 533w,{%- endif -%}
                  {%- if image.width >= 720 -%}{{ image | image_url: width: 720 }} 720w,{%- endif -%}
                  {%- if image.width >= 940 -%}{{ image | image_url: width: 940 }} 940w,{%- endif -%}
                  {%- if image.width >= 1066 -%}{{ image | image_url: width: 2066 }} 2066w,{%- endif -%}
                  {{ image | image_url }} {{ image.width }}w
                "
                src="{{ image | image_url: 'master' }}"
                sizes="(min-width: {{ settings.page_width }}px) {{ settings.page_width | minus: 130 | divided_by: 4 }}px, (min-width: 990px) calc((100vw - 130px) / 4), (min-width: 750px) calc((100vw - 120px) / 3), calc((100vw - 35px) / 2)"
                alt="{{ image.alt | escape }}"
                {% unless lazy_load == false %}
                  loading="lazy"
                {% endunless %}
                width="{{ image.width }}"
                height="{{ image.height }}"
              >
              {% comment %}
                {%- liquid
                  assign image_height = section.settings.icon_03.width | divided_by: section.settings.icon_03.aspect_ratio
                  assign sizes = full_width
                -%}
                {{
                  section.settings.icon_03
                  | image_url: width: 3840
                  | image_tag:
                    loading: 'lazy',
                    width: section.settings.icon_03.width,
                    height: image_height,
                    sizes: sizes,
                    widths: widths
                }}
              {% endcomment %}
            </figure>
          {% endif %}
        </div>
        {% if section.settings.title != blank %}
          <h2>{{ section.settings.title }}</h2>
        {% endif %}
        {% if section.settings.desc != blank %}
          <p>{{ section.settings.desc }}</p>
        {% endif %}
      </div>
      <div class="our-newsletter-form">
        {% form 'customer', class: 'newsletter-form' %}
          <input type="hidden" name="contact[tags]" value="newsletter">
          <div
            class="newsletter-form__field-wrapper{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
            {% if settings.animations_reveal_on_scroll %}
              data-cascade
              style="--animation-order: {{ forloop.index }};"
            {% endif %}
          >
            <div class="field">
              <div class="field-inner">
                <input
                  id="NewsletterForm--{{ section.id }}"
                  type="email"
                  name="contact[email]"
                  class="field__input"
                  value="{{ form.email }}"
                  aria-required="true"
                  autocorrect="off"
                  autocapitalize="off"
                  autocomplete="email"
                  {% if form.errors %}
                    autofocus
                    aria-invalid="true"
                    aria-describedby="Newsletter-error--{{ section.id }}"
                  {% elsif form.posted_successfully? %}
                    aria-describedby="Newsletter-success--{{ section.id }}"
                  {% endif %}
                  placeholder="{{ 'newsletter.label' | t }}"
                  required
                >
                <p>By signing up, you accept the terms of Muir Privacy Policy</p>
                <label class="field__label" for="NewsletterForm--{{ section.id }}">
                  {{ 'newsletter.label' | t }}
                </label>
              </div>
              <button
                type="submit"
                class="newsletter-form__button field__button"
                name="commit"
                id="Subscribe"
                aria-label="{{ 'newsletter.button_label' | t }}"
              >
                {% comment %}
                  {% render 'icon-arrow' %}
                {% endcomment %}
                Submit
              </button>
            </div>

            {%- if form.errors -%}
              <small class="newsletter-form__message form__message" id="Newsletter-error--{{ section.id }}">
                {%- render 'icon-error' -%}
                {{- form.errors.translated_fields.email | capitalize }}
                {{ form.errors.messages.email -}}
              </small>
            {%- endif -%}
          </div>
          {%- if form.posted_successfully? -%}
            <h3
              class="newsletter-form__message newsletter-form__message--success form__message"
              id="Newsletter-success--{{ section.id }}"
              tabindex="-1"
              autofocus
            >
              {% render 'icon-success' -%}
              {{- 'newsletter.success' | t }}
            </h3>
          {%- endif -%}
        {% endform %}
      </div>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Our Newsletter",
  "settings": [
    {
      "type": "image_picker",
      "id": "bg_image",
      "label": "Background Image"
    },
    {
      "type": "image_picker",
      "id": "icon_01",
      "label": "Icon 01"
    },
    {
      "type": "image_picker",
      "id": "icon_02",
      "label": "Icon 02"
    },
    {
      "type": "image_picker",
      "id": "icon_03",
      "label": "Icon 03"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Heading"
    },
    {
      "type": "textarea",
      "id": "desc",
      "label": "Description"
    }
  ],
  "presets": [
    {
      "name": "Our Newsletter",
      "category": "Newsletter"
    }
  ]
}
{% endschema %}

{% stylesheet %}
{% endstylesheet %}

{% javascript %}
{% endjavascript %}
